OPTION, ECHO=FALSE;
Option, PSDUMPFREQ=_SPT_/_DPT_;
OPTION, SPTDUMPFREQ=1;
Option, PSDUMPEACHTURN=TRUE;
Option, PSDUMPFRAME=GLOBAL;
Option, REPARTFREQ=10;
Option, REMOTEPARTDEL=1000;
Option, VERSION=10900;

TITLE,STRING="IsoDAR Track Bunch";

REAL H2MASS=2.01465054*931.49432/1000.0 ;//GeV
REAL Edes=0.19376561455665656*2.01465054/1000.0;
REAL gamma=(Edes+H2MASS)/H2MASS;
REAL beta=sqrt(1-(1/gamma^2));
REAL gambet=gamma*beta;
REAL P0 = gamma*beta*H2MASS;
REAL brho = (H2MASS*1.0e9*gambet) / CLIGHT;

VALUE,{gamma,brho,Edes,beta,gambet,H2MASS};
VALUE,{gambet};

REAL TURNS=_TURNS_;
REAL SPT=_SPT_;

// Full cyclotron frequency ~32.8
REAL frequency=32.7746; //MHz

REAL rinit0=0.1179*1000;
REAL pr0=0.0023;
REAL phi0=-135;
REAL z0=0;
REAL pz0=0;

VALUE,{rinit0, pr0};

REAL harmno=4;
REAL dee_opening_angle = 42;  // deg 45 for harmonic 4, but a slightly smaller angle yields better results
REAL rf1a_angle = (90.0 - dee_opening_angle) / 2.0;  // deg
REAL Gapwidth=10;  // mm
REAL vol=0.250;  // MV

// RF phases according to geometry
REAL phi1a = 285; //somewhat arbitrary...depends on starting pos of bunch latest was 271 in harm 6 with PHIINIT
REAL phi1b = phi1a+harmno*dee_opening_angle;

REAL phi2a = phi1a+harmno*90;
REAL phi2b = phi2a+harmno*dee_opening_angle;

REAL phi3a = phi2a+harmno*90;
REAL phi3b = phi3a+harmno*dee_opening_angle;

REAL phi4a = phi3a+harmno*90;
REAL phi4b = phi4a+harmno*dee_opening_angle;

// Cyclotron
Inj60: CYCLOTRON, TYPE="BANDRF", CYHARMON=harmno, 
       ZINIT=z0, PHIINIT=phi0, PRINIT=pr0, PZINIT=pz0, RINIT=rinit0, 
       SYMMETRY=1.0, RFFREQ=frequency, 
       FMAPFN="Injmap20120405_Symmetrized.dat", 
       MINZ=-40, MAXZ=40,MINR=0,MAXR=3000,
       RFMAPFN={"ESC1_r1_field_new.h5part", "ESC2_r1_field_new.h5part"}, 
       RFFREQ={1.0e-36,1.0e-36}, 
       RFPHI={0.0, 0.0}, 
       SUPERPOSE={TRUE, TRUE}, 
       ESCALE={1.0, 1.0};

// RF Cavity Elements
rf1a: RFCavity, VOLT=vol, FMAPFN="InjRFVoltage.dat", TYPE="SINGLEGAP",FREQ=frequency, RMIN = 40.0,
RMAX = 2100.0, ANGLE=rf1a_angle, PDIS = 0.0, GAPWIDTH = Gapwidth, PHI0=phi1a;

rf1b: RFCavity, VOLT=vol, FMAPFN="InjRFVoltage.dat", TYPE="SINGLEGAP",FREQ=frequency, RMIN = 40.0,
RMAX = 2100.0, ANGLE=rf1a_angle+dee_opening_angle, PDIS = 0.0, GAPWIDTH = Gapwidth, PHI0=phi1b;

rf2a: RFCavity, VOLT=vol, FMAPFN="InjRFVoltage.dat", TYPE="SINGLEGAP",FREQ=frequency, RMIN = 40.0,
RMAX = 2100.0, ANGLE=rf1a_angle+90.0, PDIS = 0.0, GAPWIDTH = Gapwidth, PHI0=phi2a;

rf2b: RFCavity, VOLT=vol, FMAPFN="InjRFVoltage.dat", TYPE="SINGLEGAP",FREQ=frequency, RMIN = 40.0,
RMAX = 2100.0, ANGLE=rf1a_angle+90.0+dee_opening_angle, PDIS = 0.0, GAPWIDTH = Gapwidth, PHI0=phi2b;

rf3a: RFCavity, VOLT=vol, FMAPFN="InjRFVoltage.dat", TYPE="SINGLEGAP",FREQ=frequency, RMIN = 40.0,
RMAX = 2100.0, ANGLE=rf1a_angle+2.0*90.0, PDIS = 0.0, GAPWIDTH = Gapwidth, PHI0=phi3a;

rf3b: RFCavity, VOLT=vol, FMAPFN="InjRFVoltage.dat", TYPE="SINGLEGAP",FREQ=frequency, RMIN =40.0,
RMAX = 2100.0, ANGLE=rf1a_angle+2.0*90.0+dee_opening_angle, PDIS = 0.0, GAPWIDTH = Gapwidth, PHI0=phi3b;

rf4a: RFCavity, VOLT=vol, FMAPFN="InjRFVoltage.dat", TYPE="SINGLEGAP",FREQ=frequency, RMIN = 40.0,
RMAX = 2100.0, ANGLE=rf1a_angle+3.0*90.0, PDIS = 0.0, GAPWIDTH = Gapwidth, PHI0=phi4a;

rf4b: RFCavity, VOLT=vol, FMAPFN="InjRFVoltage.dat", TYPE="SINGLEGAP",FREQ=frequency, RMIN = 40.0,
RMAX = 2100.0, ANGLE=rf1a_angle+3.0*90.0+dee_opening_angle, PDIS = 0.0, GAPWIDTH = Gapwidth, PHI0=phi4b;

probe25: Probe, xstart=1750*cos(0.436332312998), xend=2000*cos(0.436332312998), ystart=1750*sin(0.436332312998), yend=2000*sin(0.436332312998);

probe30: Probe, xstart=1750*cos(0.52359877559829), xend=2000*cos(0.52359877559829), ystart=1750*sin(0.52359877559829), yend=2000*sin(0.52359877559829);

// Beamstop:
beamstop: CCOLLIMATOR, XSTART=-2260.0, XEND=-2260.0, YSTART=60.0, YEND=-60.0, WIDTH=200.0;

// Collimators:
//Collim_1a:CCOLLIMATOR, XSTART=143.64081763847733, YSTART=19.228387208770847, XEND=138.6631498005921, YEND=18.756346007515276, WIDTH=5.0;

Collim_1b:CCOLLIMATOR, XSTART=155.58722044940194, YSTART=20.361286091784212, XEND=160.56488828728718, YEND=20.83332729303978, WIDTH=5.0;

//Collim_2a:CCOLLIMATOR, XSTART=-157.8310953802109, YSTART=63.79444186740935, XEND=-151.74668555359207, YEND=60.33323441021411, WIDTH=5.0;

Collim_2b:CCOLLIMATOR, XSTART=-166.52310941823788, YSTART=68.73902394911681, XEND=-172.60751924485672, YEND=72.20023140631204, WIDTH=5.0;

Collim_3a:CCOLLIMATOR, XSTART=200.79479620955004, YSTART=-27.125639827278665, XEND=195.9271064648848, YEND=-25.98301278852952, WIDTH=5.0;

Collim_3b:CCOLLIMATOR, XSTART=210.53017569888056, YSTART=-29.410893904776945, XEND=215.3978654435458, YEND=-30.553520943526088, WIDTH=5.0;

//Collim_4a:CCOLLIMATOR, XSTART=-222.13171605822282, YSTART=46.03848011812568, XEND=-217.38570151963592, YEND=44.46515688384681, WIDTH=5.0;

Collim_4b:CCOLLIMATOR, XSTART=-231.62374513539663, YSTART=49.185126586683445, XEND=-236.36975967398354, YEND=50.75844982096232, WIDTH=5.0;

Collim_5a:CCOLLIMATOR, XSTART=9.485152118510719, YSTART=-241.04339902505583, XEND=9.330079097512456, YEND=-236.04580436780736, WIDTH=5.0;

Collim_5b:CCOLLIMATOR, XSTART=9.795298160507247, YSTART=-251.03858833955277, XEND=9.950371181505512, YEND=-256.03618299680124, WIDTH=5.0;

Collim_6a:CCOLLIMATOR, XSTART=123.4455238635514, YSTART=217.75052286744383, XEND=119.21374563096927, YEND=212.17449802977998, WIDTH=5.0;

Collim_6b:CCOLLIMATOR, XSTART=128.28184184364528, YSTART=224.12312268191678, XEND=132.5136200762274, YEND=229.69914751958063, WIDTH=5.0;

//Collim_7a:CCOLLIMATOR, XSTART=-272.87057481651755, YSTART=-25.305324143019284, XEND=-267.9079315612767, YEND=-24.695265194054063, WIDTH=5.0;

Collim_7b:CCOLLIMATOR, XSTART=-284.7809186290956, YSTART=-26.769465620535826, XEND=-289.74356188433643, YEND=-27.37952456950105, WIDTH=5.0;

//Collim_8a:CCOLLIMATOR, XSTART=293.5429035308509, YSTART=27.811832666320925, XEND=286.5977187345981, YEND=26.937528288029668, WIDTH=5.0;

Collim_8b:CCOLLIMATOR, XSTART=303.4645960969263, YSTART=29.060838921022725, XEND=310.40978089317906, YEND=29.935143299313985, WIDTH=5.0;

Collim_9a:CCOLLIMATOR, XSTART=62.85694814802673, YSTART=294.10594385566844, XEND=61.18320637513752, YEND=289.39440605175713, WIDTH=5.0;

Collim_9b:CCOLLIMATOR, XSTART=66.20443169380513, YSTART=303.5290194634912, XEND=67.87817346669434, YEND=308.2405572674025, WIDTH=5.0;

Collim_10a:CCOLLIMATOR, XSTART=-67.27704592107511, YSTART=-310.3972092433055, XEND=-65.58268506665426, YEND=-305.6930471186539, WIDTH=5.0;

Collim_10b:CCOLLIMATOR, XSTART=-70.66576762991683, YSTART=-319.80553349260856, XEND=-72.3601284843377, YEND=-324.50969561726015, WIDTH=5.0;


// Septum:
SEP1_01: CCOLLIMATOR, XSTART=1791.6987952127295, YSTART=835.4828693147804, XEND=1774.4586658351518, YEND=857.9978815993159, WIDTH=0.5;

SEP1_02: CCOLLIMATOR, XSTART=1770.1652726421876, YSTART=863.5585220575332, XEND=1752.8448641254179, YEND=885.8096781490344, WIDTH=0.5;

SEP1_03: CCOLLIMATOR, XSTART=1748.5318364435245, YSTART=891.3059092132618, XEND=1731.1359481057264, YEND=913.3037187518481, WIDTH=0.5;

SEP1_04: CCOLLIMATOR, XSTART=1726.8053857490133, YSTART=918.7386763823105, XEND=1709.3397402084947, YEND=940.4946279792636, WIDTH=0.5;

SEP1_05: CCOLLIMATOR, XSTART=1704.9917764739178, YSTART=945.8705456208041, XEND=1687.458253270518, YEND=967.3944885343711, WIDTH=0.5;

SEP1_06: CCOLLIMATOR, XSTART=1683.0938887539228, YSTART=972.7141408732185, XEND=1665.4934766290326, YEND=994.0156824623222, WIDTH=0.5;

SEP1_07: CCOLLIMATOR, XSTART=1661.112483957097, YSTART=999.2812157035975, XEND=1643.4459240370822, YEND=1020.3700364658366, WIDTH=0.5;

SEP1_08: CCOLLIMATOR, XSTART=1639.048323403551, YSTART=1025.5837779850667, XEND=1621.3147102922155, YEND=1046.4687437152145, WIDTH=0.5;

SEP1_09: CCOLLIMATOR, XSTART=1616.9005728337354, YSTART=1051.6331002823276, XEND=1599.0990083070456, YEND=1072.3232150835688, WIDTH=0.5;

SEP1_10: CCOLLIMATOR, XSTART=1594.6676381149339, YSTART=1077.4401351126974, XEND=1576.7965278123988, YEND=1097.9440731577363, WIDTH=0.5;

SEP1_11: CCOLLIMATOR, XSTART=1572.3476787162997, YSTART=1103.0158238346232, XEND=1554.4045292882233, YEND=1123.3417420642793, WIDTH=0.5;

SEP1_12: CCOLLIMATOR, XSTART=1549.9375043124533, YSTART=1128.3703066883302, XEND=1531.9199492383775, YEND=1148.5265251425635, WIDTH=0.5;

SEP1_13: CCOLLIMATOR, XSTART=1527.433902083085, YSTART=1153.5137898894086, XEND=1509.3385314410416, YEND=1173.507929587365, WIDTH=0.5;

SEP1_14: CCOLLIMATOR, XSTART=1504.832945138482, YSTART=1178.4560435677486, XEND=1486.6563205959405, YEND=1198.2957467758426, WIDTH=0.5;

SEP1_15: CCOLLIMATOR, XSTART=1482.1299307975341, YSTART=1203.2062953884063, XEND=1463.8682733943695, YEND=1222.898977245812, WIDTH=0.5;

SEP1_16: CCOLLIMATOR, XSTART=1459.3202950764198, YSTART=1227.7739299443715, XEND=1440.9691877321168, YEND=1247.326518018019, WIDTH=0.5;

SEP1_17: CCOLLIMATOR, XSTART=1436.3984543069976, YSTART=1252.1675418645311, XEND=1417.9535676912847, YEND=1271.5870587117192, WIDTH=0.5;

SEP1_18: CCOLLIMATOR, XSTART=1413.3588250278597, YSTART=1276.3957440849574, XEND=1394.815168691132, YEND=1295.6886561756571, WIDTH=0.5;

SEP1_19: CCOLLIMATOR, XSTART=1390.1954363238192, YSTART=1300.466846786038, XEND=1371.5479447837042, YEND=1319.6395673513575, WIDTH=0.5;

SEP1_20: CCOLLIMATOR, XSTART=1366.9016289133976, YSTART=1324.3885467391383, XEND=1348.1447948926077, YEND=1343.4470760957176, WIDTH=0.5;

SEP1_21: CCOLLIMATOR, XSTART=1343.4706255639728, YSTART=1348.1684267078206, XEND=1324.598296950635, YEND=1367.118112139914, WIDTH=0.5;

SEP1_22: CCOLLIMATOR, XSTART=1319.894715950694, YSTART=1371.813129721844, XEND=1300.9016642036831, YEND=1390.6602549319512, WIDTH=0.5;

SEP1_23: CCOLLIMATOR, XSTART=1296.1673111184393, YSTART=1395.3304430755916, XEND=1277.0473974715867, YEND=1414.0804037930038, WIDTH=0.5;

SEP1_24: CCOLLIMATOR, XSTART=1272.2808534948917, YSTART=1418.7272219851884, XEND=1253.027502217955, YEND=1437.3849402852118, WIDTH=0.5;

SEP1_25: CCOLLIMATOR, XSTART=1248.2268102745668, YSTART=1442.009246917021, XEND=1228.833079781005, YEND=1460.5791903945478, WIDTH=0.5;

SEP1_26: CCOLLIMATOR, XSTART=1223.9967888803492, YSTART=1465.1824061656484, XEND=1204.4557351612693, YEND=1483.6690119103794, WIDTH=0.5;

SEP1_27: CCOLLIMATOR, XSTART=1199.5818928447932, YSTART=1488.2519677371076, XEND=1179.8864449761345, YEND=1506.6595004655646, WIDTH=0.5;

SEP1_28: CCOLLIMATOR, XSTART=1174.973299948895, YSTART=1511.2232566258704, XEND=1155.1158559068288, YEND=1529.5552897681152, WIDTH=0.5;

SEP1_29: CCOLLIMATOR, XSTART=1150.1615791805482, YSTART=1534.1008060527731, XEND=1130.134543163884, YEND=1552.3608721232943, WIDTH=0.5;

SEP1_30: CCOLLIMATOR, XSTART=1125.1370224497482, YSTART=1556.8887171876122, XEND=1104.9323130610314, YEND=1575.0796317139923, WIDTH=0.5;

SEP1_31: CCOLLIMATOR, XSTART=1099.889788467472, YSTART=1579.590838760933, XEND=1079.4991579139466, YEND=1597.7150993336952, WIDTH=0.5;

SEP1_32: CCOLLIMATOR, XSTART=1074.4093012312499, YSTART=1602.20987846548, XEND=1053.8243987652304, YEND=1620.2697248424577, WIDTH=0.5;

SEP1_33: CCOLLIMATOR, XSTART=1048.6852684676448, YSTART=1624.7488159054271, XEND=1027.897136342726, YEND=1642.7454432478248, WIDTH=0.5;

SEP1_34: CCOLLIMATOR, XSTART=1022.7063740519516, YSTART=1647.208916231929, XEND=1001.7062260965779, YEND=1665.1435964949922, WIDTH=0.5;

SEP1_35: CCOLLIMATOR, XSTART=996.4615811553455, YSTART=1669.591629595427, XEND=975.2397851060309, YEND=1687.4640281348481, WIDTH=0.5;

SEP1_36: CCOLLIMATOR, XSTART=969.9389810876902, YSTART=1691.8966959227905, XEND=948.4862212266629, YEND=1709.7066980015634, WIDTH=0.5;

SEP1_37: CCOLLIMATOR, XSTART=943.1266909880679, YSTART=1714.1234888507913, XEND=921.4326793067856, YEND=1731.8688699353174, WIDTH=0.5;

SEP1_38: CCOLLIMATOR, XSTART=916.0121131570756, YSTART=1736.269617026888, XEND=894.0669908797494, YEND=1753.9484270292814, WIDTH=0.5;

SEP1_39: CCOLLIMATOR, XSTART=888.5825887117239, YSTART=1758.3319141750915, XEND=866.3753512057286, YEND=1775.9393493373273, WIDTH=0.5;

SEP1_40: CCOLLIMATOR, XSTART=860.8245833990168, YSTART=1780.3046773601016, XEND=838.3440752685016, YEND=1797.8346711814888, WIDTH=0.5;

SEP2_01: CCOLLIMATOR, XSTART=693.6659984666699, YSTART=1905.8316674306193, XEND=669.2966950086781, YEND=1922.4984824865685, WIDTH=0.5;

SEP2_02: CCOLLIMATOR, XSTART=663.1921827021199, YSTART=1926.5961023509087, XEND=638.4152985956961, YEND=1942.8939617946703, WIDTH=0.5;

SEP2_03: CCOLLIMATOR, XSTART=632.2028721188989, YSTART=1946.8764904538489, XEND=606.9583932868903, YEND=1962.5844931644012, WIDTH=0.5;

SEP2_04: CCOLLIMATOR, XSTART=600.6280848742656, YSTART=1966.4070367825718, XEND=574.9112621608506, YEND=1981.4389099970206, WIDTH=0.5;

SEP2_05: CCOLLIMATOR, XSTART=568.4619537538662, YSTART=1985.0773677571624, XEND=542.2704884476686, YEND=1999.3344528073842, WIDTH=0.5;

SEP2_06: CCOLLIMATOR, XSTART=535.7063500405862, YSTART=2002.778415635464, XEND=509.06149045870166, YEND=2016.2300349719214, WIDTH=0.5;

SEP2_07: CCOLLIMATOR, XSTART=502.38748969707257, YSTART=2019.47018294474, XEND=475.3132171536161, YEND=2032.0910491773993, WIDTH=0.5;

SEP2_08: CCOLLIMATOR, XSTART=468.5356194152289, YSTART=2035.1217710326698, XEND=441.0578501809622, YEND=2046.8906513850368, WIDTH=0.5;

SEP2_09: CCOLLIMATOR, XSTART=434.1831581552921, YSTART=2049.706438277153, XEND=406.32943815576664, YEND=2060.6062485613147, WIDTH=0.5;

SEP2_10: CCOLLIMATOR, XSTART=399.3648797745333, YSTART=2063.204283232083, XEND=371.1633339905577, YEND=2073.218231139577, WIDTH=0.5;

SEP2_11: CCOLLIMATOR, XSTART=364.1162214303799, YSTART=2075.595848372959, XEND=335.59646258657233, YEND=2084.712953668686, WIDTH=0.5;

SEP2_12: CCOLLIMATOR, XSTART=328.4739718707214, YSTART=2086.8663632510847, XEND=299.66602789956, YEND=2095.0770083484263, WIDTH=0.5;

SEP2_13: CCOLLIMATOR, XSTART=292.47560291876283, YSTART=2097.0035230337667, XEND=263.409982588287, YEND=2104.3006077642945, WIDTH=0.5;

SEP2_14: CCOLLIMATOR, XSTART=256.15923463148135, YSTART=2105.998464763, XEND=226.86640877626735, YEND=2112.3741889939247, WIDTH=0.5;

SEP2_15: CCOLLIMATOR, XSTART=219.5631325084233, YSTART=2113.8432130174333, XEND=190.07395378142772, YEND=2119.2927164662483, WIDTH=0.5;

SEP2_16: CCOLLIMATOR, XSTART=182.725826151289, YSTART=2120.5321531748887, XEND=153.07124122306337, YEND=2125.0520923996905, WIDTH=0.5;

SEP2_17: CCOLLIMATOR, XSTART=145.68582963499625, YSTART=2126.059967287022, XEND=115.89683814414573, YEND=2129.648762093879, WIDTH=0.5;

SEP2_18: CCOLLIMATOR, XSTART=108.48182505837636, YSTART=2130.424364052594, XEND=78.58936139598879, YEND=2133.081978413578, WIDTH=0.5;

SEP2_19: CCOLLIMATOR, XSTART=71.15244114671279, YSTART=2133.6253108497017, XEND=41.187213071135915, YEND=2135.349224143093, WIDTH=0.5;

SEP2_20: CCOLLIMATOR, XSTART=33.73607243891439, YSTART=2135.6616758059017, XEND=3.7288164601187654, YEND=2136.452288099305, WIDTH=0.5;

SEP2_21: CCOLLIMATOR, XSTART=-3.728958292149915, YSTART=2136.533551784787, XEND=-33.74760275139931, YEND=2136.391602104473, WIDTH=0.5;

SEP2_22: CCOLLIMATOR, XSTART=-41.20441510688607, YSTART=2136.241062919071, XEND=-71.20390077906593, YEND=2135.1684142528425, WIDTH=0.5;

SEP2_23: CCOLLIMATOR, XSTART=-78.65214258842637, YSTART=2134.785993152884, XEND=-108.60196643525302, YEND=2132.783764959517, WIDTH=0.5;

SEP2_24: CCOLLIMATOR, XSTART=-116.03405070143722, YSTART=2132.170095354202, XEND=-145.90367799493592, YEND=2129.239128075452, WIDTH=0.5;

SEP2_25: CCOLLIMATOR, XSTART=-153.31206570875685, YSTART=2128.3954021758022, XEND=-183.07093731627594, YEND=2124.5371662438574, WIDTH=0.5;

SEP2_26: CCOLLIMATOR, XSTART=-190.44811157546442, YSTART=2123.4645131376765, XEND=-220.06569258910775, YEND=2118.681608259613, WIDTH=0.5;

SEP2_27: CCOLLIMATOR, XSTART=-227.40397560949762, YSTART=2117.3795236730407, XEND=-256.84985676575485, YEND=2111.6763750542455, WIDTH=0.5;

SEP2_28: CCOLLIMATOR, XSTART=-264.14164687929247, YSTART=2110.145646730218, XEND=-293.3853643007123, YEND=2103.5263673463455, WIDTH=0.5;

SEP2_29: CCOLLIMATOR, XSTART=-300.623081031724, YSTART=2101.768123877999, XEND=-329.6344104265138, YEND=2094.2388810031325, WIDTH=0.5;

SEP2_30: CCOLLIMATOR, XSTART=-336.8105271316189, YSTART=2092.254678227223, XEND=-365.55917049432423, YEND=2083.8211866310876, WIDTH=0.5;

SEP2_31: CCOLLIMATOR, XSTART=-372.66635712088623, YSTART=2081.613712778667, XEND=-401.1225187145429, YEND=2072.284621471763, WIDTH=0.5;

SEP2_32: CCOLLIMATOR, XSTART=-408.15343724336776, YSTART=2069.856240229008, XEND=-436.28775560482114, YEND=2059.641892615384, WIDTH=0.5;

SEP2_33: CCOLLIMATOR, XSTART=-443.2352871680347, YSTART=2056.995846000642, XEND=-471.0191061159333, YEND=2045.9089932698653, WIDTH=0.5;

SEP2_34: CCOLLIMATOR, XSTART=-477.87618993970096, YSTART=2043.0484428915418, XEND=-505.2818843982394, YEND=2031.1049149325981, WIDTH=0.5;

SEP2_35: CCOLLIMATOR, XSTART=-512.0417251903901, YSTART=2028.0337932406542, XEND=-539.0431991661768, YEND=2015.2534766543563, WIDTH=0.5;

SEP2_36: CCOLLIMATOR, XSTART=-545.6994241541438, YSTART=2011.9768322849056, XEND=-572.2730528001879, YEND=1998.385780770865, WIDTH=0.5;

SEP2_37: CCOLLIMATOR, XSTART=-578.8200483889322, YSTART=1994.9105909901361, XEND=-604.9448146446654, YEND=1980.5396556363494, WIDTH=0.5;

SEP2_38: CCOLLIMATOR, XSTART=-611.3794546328994, YSTART=1976.8798823327068, XEND=-637.0518060017664, YEND=1961.808841755383, WIDTH=0.5;

SEP2_39: CCOLLIMATOR, XSTART=-643.3731200842077, YSTART=1957.9821363025083, XEND=-668.6073883465899, YEND=1942.327461013125, WIDTH=0.5;

SEP2_40: CCOLLIMATOR, XSTART=-674.8272823842614, YSTART=1938.3846297156078, XEND=-699.6658389805641, YEND=1922.3160937628725, WIDTH=0.5;


l1: LINE = (Inj60,rf1a,rf1b,rf2a,rf2b,rf3a,rf3b,rf4a,rf4b,probe25,probe30,beamstop,
           Collim_1b, Collim_2b, Collim_3b,
           Collim_4b, Collim_5b, Collim_6b, Collim_7b,
           Collim_8b, Collim_9a, Collim_9b, Collim_10a, Collim_10b,
           SEP1_01, SEP1_02, SEP1_03, SEP1_04, SEP1_05, SEP1_06, SEP1_07, SEP1_08, SEP1_09, SEP1_10, SEP1_11, SEP1_12, SEP1_13, SEP1_14, SEP1_15, SEP1_16, SEP1_17, SEP1_18, SEP1_19, SEP1_20, SEP1_21, SEP1_22, SEP1_23, SEP1_24, SEP1_25, SEP1_26, SEP1_27, SEP1_28, SEP1_29, SEP1_30, SEP1_31, SEP1_32, SEP1_33, SEP1_34, SEP1_35, SEP1_36, SEP1_37, SEP1_38, SEP1_39, SEP1_40, SEP2_01, SEP2_02, SEP2_03, SEP2_04, SEP2_05, SEP2_06, SEP2_07, SEP2_08, SEP2_09, SEP2_10, SEP2_11, SEP2_12, SEP2_13, SEP2_14, SEP2_15, SEP2_16, SEP2_17, SEP2_18, SEP2_19, SEP2_20, SEP2_21, SEP2_22, SEP2_23, SEP2_24, SEP2_25, SEP2_26, SEP2_27, SEP2_28, SEP2_29, SEP2_30, SEP2_31, SEP2_32, SEP2_33, SEP2_34, SEP2_35, SEP2_36, SEP2_37, SEP2_38, SEP2_39, SEP2_40);

REAL PxineV=(sqrt(0.0001342^2+1)-1)*H2MASS*1e9;
REAL PyineV=(sqrt(8.49e-05^2+1)-1)*H2MASS*1e9;
REAL PzineV=(sqrt(0.0001181^2+1)-1)*H2MASS*1e9;
VALUE,{PxineV};

Dist1:DISTRIBUTION, TYPE = GAUSS,
SIGMAX=0.001,
SIGMAY=0.003,
SIGMAZ=0.005,
SIGMAPX=PxineV,
SIGMAPY=PyineV,
SIGMAPZ=PzineV,
CORRX=-0.002156,
CORRY=0.003609,
CORRZ=-8.356e-05,
R61=0.6929,
R62=-0.0008288,
R51=-0.0007278,
R52=0.7025,
CUTOFFX=4,
CUTOFFY=4,
CUTOFFLONG=4,
CUTOFFPX=4,
CUTOFFPY=4,
CUTOFFPZ=4,
OFFSETX=0.0,
OFFSETY=0.0,
OFFSETZ=0.0;

//Dist1:DISTRIBUTION, TYPE=FROMFILE, 

VALUE,{PxineV};

REAL Gridsize=_NGRID_;

Fs1:FIELDSOLVER, FSTYPE=FFT, MX=Gridsize, MY=Gridsize, MT=Gridsize,
                 PARFFTX=true, PARFFTY=true, PARFFTT=true,
                 BCFFTX=open, BCFFTY=open, BCFFTT=open;


beam1: BEAM, PC=P0, PARTICLE=H2PLUS, CHARGE=1, MASS=H2MASS, NPART=_NPART_, BCURRENT=_IBEAM_, BFREQ= frequency;

SELECT, LINE=l1;

TRACK,LINE=l1, BEAM=beam1, MAXSTEPS=SPT * TURNS, STEPSPERTURN=SPT, TIMEINTEGRATOR="RK-4";
RUN, METHOD = "CYCLOTRON-T",BEAM=beam1, FIELDSOLVER=Fs1, 
     DISTRIBUTION=Dist1;
ENDTRACK;

STOP;
